# Streamlit应用更新部署指南

## 🎯 更新目标
将本地修改后的内购系统代码更新到已部署的Streamlit Cloud应用。

## 📋 更新步骤

### 方法一：通过GitHub更新（推荐）

#### 1. 提交本地修改到GitHub
```bash
# 进入项目目录
cd "c:\Users\huishi00\Desktop\内购系统"

# 查看修改的文件
git status

# 添加所有修改的文件
git add .

# 提交修改（包含描述信息）
git commit -m "更新内购系统：添加购物车数量修改功能和订单原价修复"

# 推送到GitHub
git push origin main
```

#### 2. Streamlit Cloud自动更新
- Streamlit Cloud会自动检测到GitHub仓库的更新
- 应用会在几分钟内自动重新部署
- 无需手动操作

### 方法二：如果没有使用Git

#### 1. 手动上传文件到GitHub
1. **登录GitHub网站**：
   - 打开 [github.com](https://github.com)
   - 登录您的账户

2. **进入仓库**：
   - 找到您的内购系统仓库
   - 点击进入仓库页面

3. **上传修改的文件**：
   - 点击 "Upload files" 按钮
   - 拖拽以下关键文件到上传区域：
     - `app.py` (主程序文件)
     - `requirements.txt` (如果有修改)
     - 其他修改过的文件

4. **提交更改**：
   - 在页面底部填写提交信息：
     ```
     更新内购系统功能
     
     - 修复订单原价更新问题
     - 添加购物车数量修改功能
     - 完善限购检查逻辑
     ```
   - 点击 "Commit changes" 按钮

#### 2. 确认Streamlit更新
- GitHub更新后，Streamlit Cloud会自动重新部署
- 查看应用状态和日志

## 📁 需要更新的关键文件

### 必须更新的文件：
- ✅ **app.py** - 主程序文件（包含所有功能修改）
- ✅ **requirements.txt** - 依赖包列表（如果有新依赖）

### 可选更新的文件：
- 📄 **README.md** - 项目说明文档
- 📄 **商品导入模板_含限购.csv** - 更新的导入模板
- 📄 **最终系统说明.md** - 功能说明文档
- 📄 **购物车数量修改功能说明.md** - 新功能说明
- 📄 **订单原价修复说明.md** - 修复说明

### 不需要更新的文件：
- ❌ **orders.json** - 订单数据（保留线上数据）
- ❌ **inventory.json** - 库存数据（保留线上数据）
- ❌ **users.json** - 用户数据（保留线上数据）

## ⚠️ 重要注意事项

### 数据安全
- **不要上传数据文件**：`orders.json`、`inventory.json`、`users.json`
- 这些文件包含实际的业务数据，应该保留线上版本
- 只上传代码文件，不上传数据文件

### 更新确认
- 更新后访问您的Streamlit应用网址
- 测试新功能是否正常工作：
  - 购物车数量修改功能
  - 订单修改后原价更新
  - 限购检查逻辑

## 🔄 更新验证清单

### 功能测试
- [ ] 购物车可以修改商品数量
- [ ] 订单修改后原价正确更新
- [ ] 限购检查功能正常
- [ ] 支付功能正常工作
- [ ] 数据导入导出功能正常

### 界面测试
- [ ] 所有页面正常显示
- [ ] 按钮和输入框响应正常
- [ ] 错误提示信息正确显示
- [ ] 数据表格正常渲染

## 🚀 快速更新命令（如果使用Git）

```bash
# 一键更新脚本
cd "c:\Users\huishi00\Desktop\内购系统"
git add app.py requirements.txt *.md *.csv
git commit -m "功能更新：购物车数量修改+订单原价修复"
git push origin main
echo "更新已推送到GitHub，Streamlit将自动重新部署"
```

## 📱 更新后的新功能

用户将能够体验到：

1. **购物车数量修改**：
   - 直接在购物车中调整商品数量
   - 智能库存和限购检查
   - 实时价格更新

2. **订单原价修复**：
   - 修改订单后原价正确显示
   - 数据一致性得到保证
   - 准确的折扣计算

3. **完善的限购逻辑**：
   - 严格防止分批购买绕过限购
   - 详细的错误提示信息
   - 历史购买记录考虑

## 💡 提示

- 更新通常需要2-5分钟生效
- 如果遇到问题，可以在Streamlit Cloud查看部署日志
- 建议在更新前备份重要数据

更新完成后，您的用户就可以享受改进后的购物体验了！
